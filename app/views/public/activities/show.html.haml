= render 'layouts/header_menu'

.activity-show-title
  %h2 活動報告詳細ページ
  .activity-show-follow
    %div{id: "favorite_buttons_#{@activity.id}"}
      = render "public/favorites/favorite", activity: @activity
    .activity-comment-icon
      = link_to '#activity-comment' do
        %i.fa-regular.fa-comments
        コメントする

.activity-show-container.px-0.px-sm-0
  .row
    .col-md-3
      .activity-show-card
        .card
          .img-container
            - if @activity.activity_image.present?
              = image_tag @activity.activity_image
            - else
              = image_tag 'no_image'
          .card-body.text-container
            %h5.card-title
              = @activity.title
            %hr
            %h6.card-subtitle
              [投稿者]
              %br
              = link_to public_customer_path(@activity.customer), data: { 'turbolinks': false } do
                .activity-owner-img
                  - if @activity.customer.profile_image.present?
                    = image_tag @activity.customer.profile_image
                  - else
                    = image_tag 'no_image'
                  .activity-name
                    = @activity.customer.name
              %hr
              [パート]
              %br
              - @activity.customer.parts.each do |part|
                🎵
                = part.name
              %hr
              [投稿日]
              = time_ago_in_words(@activity.created_at) + "前"
            %hr
            .got-favorite-count
              いいね数
              %i.fa-solid.fa-heart
              = @activity.favorites.count

    .col-md-9
      %table.table.table-striped.activity-show-table{:width=>"100%",:border=>"1"}
        %colgroup
          %col{width: "19%"}
          %col{width: "81%"}
            %tr
              %th{scope:"row"} 活動報告タイトル
              %td
                = @activity.title
            %tr
              %th{scope:"row"} 活動報告動画
              %td
                - if @activity.youtube_url.present?
                  %iframe{
                    src: "https://www.youtube.com/embed/#{@activity.youtube_url[32..42]}",
                    allow: "accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",
                    allowfullscreen: "",
                    frameborder: "0",
                    height: "315",
                    width: "560"
                  }
                - else
                  投稿された動画はありません。
            %tr
              %th{scope:"row"} やって良かった事
              %td
                %span.kpt-keep Keep
                = @activity.keep
            %tr
              %th{scope:"row"} 失敗した事
              %td
                %span.kpt-problem Problem
                = @activity.problem
            %tr
              %th{scope:"row"} 次挑戦したい事
              %td
                %span.kpt-try Try
                = @activity.try
            %tr
              %th{scope:"row"} 活動報告詳細紹介
              %td
                = simple_format(@activity.introduction)
            %tr
              %th{scope:"row"} 所属コミュニティ
              %td
                - if @activity.customer.communities.present?
                  - @activity.customer.communities.each do |community|
                    %span 🎵
                    = community.name
                    %br
                - else
                  所属コミュニティはありません。
      #activity-comment.activity-comment
        %h2 みんなのコメント
        = form_with model: [:public, @activity, @comment], local: true do |f|
          = f.text_field :comment, placeholder: '素敵な活動ですね！', style: "width:100%"
          = f.submit 'コメントする', class: "activity-comment-btn"
        .comment-part
          - @comments.each do |comment|
            .comment-content
              .commenter-image
                - if comment.customer.profile_image.present?
                  = image_tag comment.customer.profile_image, class: "icon_mini"
                - else
                  = image_tag 'no_image', class: "icon_mini"
              .comment-info
                .comment-upper
                  .comment-name
                    = comment.customer.name
                  .comment-time
                    = time_ago_in_words(comment.created_at) + "前"
                  .comment-delete
                    - if comment.customer == current_customer
                      = link_to '削除', public_activity_comment_path(comment.activity, comment), method: :delete, class: "btn btn-danger", data: { 'turbolinks': false }
                .comment-beneath
                  = comment.comment
                  %br


