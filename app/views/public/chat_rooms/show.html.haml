= render 'layouts/header_menu'

.chat-rooms-show-container
  %h4 ãƒãƒ£ãƒƒãƒˆãƒ«ãƒ¼ãƒ ã¸ã‚ˆã†ã“ã!

  .row
    .col-md-3
      .partner-index-container
        %p å€‹åˆ¥ãƒãƒ£ãƒƒãƒˆãŒã§ãã‚‹ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆ
        %strong
          = @mathing_customers.size.to_s + 'äºº'
        - @mathing_customers.each do |matching_customer|
          .form-inline
            %span
              = link_to public_chat_rooms_path(customer_id: matching_customer.id), method: :post do
                - if matching_customer.profile_image.present?
                  = image_tag matching_customer.profile_image, class: "icon_mini"
                - else
                  = image_tag 'no_image', class: "icon_mini"
                %strong.do-chat
                  = matching_customer.name + 'ã•ã‚“ã¨ ãƒãƒ£ãƒƒãƒˆğŸµ'
            %hr


    .col-md-6
      .message-container#chat-area
        - @chat_messages.each do |chat_message|
          - if chat_message.customer.id != current_customer.id
            .partner-message
              %hr
              %ul
                %li
                = link_to public_customer_path(chat_message.customer), class: "chat-room-customer-link" do
                  .img-element
                    - if chat_message.customer.profile_image.present?
                      = image_tag chat_message.customer.profile_image
                    - else
                      = image_tag 'no_image'
                  .name-element
                    = chat_message.customer.name + 'ã•ã‚“ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸'
                %li
                .partner-content
                  = simple_format(chat_message.content)
                - if chat_message.chat_image.present?
                  %li
                  .partner-chat-image
                    = image_tag chat_message.chat_image.variant(resize:'300x300'), class: 'message-image'
                %li
                = l chat_message.created_at, format: :short
                ã«é€ä¿¡æ¸ˆã¿
              %hr
          - else
            .self-message
              %hr
              %ul
                %li
                = link_to public_customer_path(chat_message.customer), class: "chat-room-customer-link" do
                  .img-element
                    - if chat_message.customer.profile_image.present?
                      = image_tag chat_message.customer.profile_image
                    - else
                      = image_tag 'no_image'
                  .name-element
                    = chat_message.customer.name + 'ã•ã‚“ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸'
                %li
                .self-content
                  = simple_format(chat_message.content)
                - if chat_message.chat_image.present?
                  %li
                  .self-chat-image
                    = image_tag chat_message.chat_image.variant(resize:'300x300'), class: 'message-image'
                %li
                = l chat_message.created_at, format: :short
                ã«é€ä¿¡æ¸ˆã¿
              %hr
      .form-container
        = form_with model: [:public, @chat_message] do |f|
          = f.hidden_field :chat_room_id, value: @chat_room.id
          = f.hidden_field :customer_id, value: @chat_room_customer.id
          = f.text_area :content, autofocus: true, class: 'chat-form'
          = f.file_field :chat_image, accept: 'image/*'
          = f.submit "ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡", class: 'btn btn-info chat-form-btn'

    .col-md-3
      .partner-container
        %p ä»Šã€ãƒãƒ£ãƒƒãƒˆã—ã¦ã„ã‚‹ãŠç›¸æ‰‹
        .card
          = link_to public_customer_path(@chat_room_customer) do
            .img-container
              - if @chat_room_customer.profile_image.present?
                = image_tag @chat_room_customer.profile_image
              - else
                = image_tag 'no_image'
          .card-body.text-container
            %h5.card-title
              = @chat_room_customer.human_attribute_enum(:name)
            %h6.card-subtitle
              Part:
              - @chat_room_customer.parts.each do |part|
                %i.fa-solid.fa-music
                = part.name
            %hr
            %p.card-text
              = @chat_room_customer.human_attribute_enum(:introduction)
            = link_to 'ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»é¢ã¸', public_customer_path(@chat_room_customer.id), class: "btn btn-info chat-partner-link", data: { 'turbolinks': false }
